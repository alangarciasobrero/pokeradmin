
<!-- Tournament Detail View (Handlebars) -->
{{!-- Contenedor principal de la vista de detalles de torneo --}}
<div class="tournament-detail-container">
    <h1>
        <svg class="trophy-icon" viewBox="0 0 24 24" fill="none"><defs><radialGradient id="gold" cx="50%" cy="50%" r="80%"><stop offset="0%" stop-color="#fffde4"/><stop offset="100%" stop-color="#FFD600"/></radialGradient></defs><path d="M7 2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h1v2.09A7.001 7.001 0 0 0 5 14a7 7 0 0 0 14 0 7.001 7.001 0 0 0-3-5.91V6h1a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H7Zm1 2V4h8v1H8Zm4 16a5 5 0 0 1-5-5c0-2.21 1.44-4.08 3.5-4.77V6h3v2.23A5.002 5.002 0 0 1 17 13a5 5 0 0 1-5 5Z" fill="url(#gold)" stroke="#FFD600" stroke-width="1.2"/><circle cx="12" cy="19" r="1.2" fill="#FFD600"/></svg>
        {{tournament.tournament_name}}
    </h1>
    {{!-- Información detallada del torneo, cada campo con su icono --}}
    <div class="tournament-info">
    {{!-- Fecha del torneo --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#3949ab"><path d="M19 4h-1V2h-2v2H8V2H6v2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Zm0 16H5V9h14v11Zm0-13H5V6h14v1Z"/><rect x="7" y="11" width="10" height="2" rx="1" fill="#3949ab"/></svg> Date:</span> {{tournament.start_date}}</p>
    {{!-- Buy-in del torneo --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#43a047"><circle cx="12" cy="12" r="10"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#fff" font-family="Arial" font-weight="bold">$</text></svg> Buy-in:</span> ${{tournament.buy_in}}</p>
    {{!-- Re-entry permitido --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#1976d2"><rect x="4" y="4" width="16" height="16" rx="8"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#fff" font-family="Arial" font-weight="bold">R</text></svg> Re-entry:</span> {{tournament.re_entry}}</p>
    {{!-- Premio por knockout --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#FFD600"><circle cx="12" cy="12" r="10"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#3949ab" font-family="Arial" font-weight="bold">K</text></svg> Knockout Bounty:</span> ${{tournament.knockout_bounty}}</p>
    {{!-- Stack inicial --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#8e24aa"><rect x="4" y="4" width="16" height="16" rx="4"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#fff" font-family="Arial" font-weight="bold">S</text></svg> Starting Stack:</span> {{tournament.starting_stack}}</p>
    {{!-- Cuenta para ranking --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#00bcd4"><circle cx="12" cy="12" r="10"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#fff" font-family="Arial" font-weight="bold">CR</text></svg> Count to Ranking:</span> <span class="badge badge-{{tournament.count_to_ranking}}">{{tournament.count_to_ranking}}</span></p>
    {{!-- Doble puntaje --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#ff7043"><rect x="4" y="4" width="16" height="16" rx="4"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#fff" font-family="Arial" font-weight="bold">DP</text></svg> Double Points:</span> <span class="badge badge-{{tournament.double_points}}">{{tournament.double_points}}</span></p>
    {{!-- Niveles de ciegas --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#3949ab"><rect x="4" y="4" width="16" height="16" rx="4"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#fff" font-family="Arial" font-weight="bold">BL</text></svg> Blind Levels:</span> {{tournament.blind_levels}}</p>
    {{!-- Small blind --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#43a047"><rect x="4" y="4" width="16" height="16" rx="4"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#fff" font-family="Arial" font-weight="bold">SB</text></svg> Small Blind:</span> {{tournament.small_blind}}</p>
    {{!-- Descuento por puntualidad --}}
    <p><span class="label"><svg class="icon" viewBox="0 0 24 24" fill="#FFD600"><rect x="4" y="4" width="16" height="16" rx="4"/><text x="12" y="16" text-anchor="middle" font-size="11" fill="#3949ab" font-family="Arial" font-weight="bold">PD</text></svg> Punctuality Discount:</span> ${{tournament.punctuality_discount}}</p>
    </div>
    {{!-- Enlace para volver a la lista de torneos --}}
    <a class="back-link" href="/tournaments">&#8592; Back to list</a>
</div>

    {{!-- Inline registration form for admins --}}
    {{#isAdmin role}}
    <div class="tournament-registrations">
        <h2>Registrar jugador</h2>
        <form method="post" action="/admin/games/tournaments/{{tournament.id}}/register">
            <label for="user_id">Usuario (seleccionar):</label>
            <select id="user_id" name="user_id">
                <option value="">-- Buscar usuario --</option>
                {{#each users}}
                    <option value="{{this.id}}">{{this.username}} {{#if this.full_name}}- {{this.full_name}}{{/if}}</option>
                {{/each}}
            </select>
            <p>O crear usuario rápido:</p>
            <label for="new_user_username">Usuario:</label>
            <input id="new_user_username" name="new_user_username" placeholder="nuevo_username">
            <label for="new_user_full_name">Nombre completo (opcional):</label>
            <input id="new_user_full_name" name="new_user_full_name" placeholder="Nombre Apellido">

            <label for="amount_paid">Monto pagado ahora:</label>
            <input type="number" id="amount_paid" name="amount_paid" step="0.01" min="0">

            <label for="method">Método de pago:</label>
            <select id="method" name="method">
                <option value="cash">Efectivo</option>
                <option value="card">Tarjeta</option>
                <option value="transfer">Transferencia</option>
                <option value="other">Otro</option>
            </select>

            <button type="submit">Registrar</button>
        </form>

        <h3>Participantes</h3>
        {{#if registrations.length}}
            <table class="registrations-table">
                <thead><tr><th>#</th><th>Usuario</th><th>Fecha</th><th>Puntualidad</th><th>Acciones</th></tr></thead>
                <tbody>
                    {{#each registrations}}
                        <tr>
                            <td>{{@index}}</td>
                            <td>{{this.user_id}}</td>
                            <td>{{formatDate this.registration_date}}</td>
                            <td>{{this.punctuality}}</td>
                            <td><a class="btn" href="/admin/registrations/{{this.id}}">Ver</a></td>
                        </tr>
                    {{/each}}
                </tbody>
            </table>
        {{else}}
            <p>No hay participantes aún.</p>
        {{/if}}
    </div>
    {{/isAdmin}}
