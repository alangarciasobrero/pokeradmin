{{! views/admin_users.handlebars }}
<div class="tournament-list-container users-container">
    <h1>Gesti√≥n de Usuarios</h1>
    
    {{!-- Campo de b√∫squeda --}}
    <div class="search-section">
        <form method="GET" action="/admin/users" class="search-form">
            <div class="search-box">
                <input type="text" name="search" id="searchInput" placeholder="üîç Buscar por usuario o nombre..." value="{{searchQuery}}" />
                <button type="submit" class="btn btn-search">üîç Buscar</button>
                {{#if searchQuery}}
                    <a href="/admin/users" class="btn btn-clear">‚úï Limpiar</a>
                {{/if}}
            </div>
        </form>
        {{#if searchQuery}}
            <p class="search-results-info">üìä Mostrando {{meta.total_items}} resultado(s) para: <strong>"{{searchQuery}}"</strong></p>
        {{/if}}
    </div>

    <div class="main-actions">
                <a class="btn" href="/admin/users/new">+ Nuevo usuario</a>
                {{#if meta}}
                    <div class="user-pagination">
                        {{#if links.prev}}<a class="btn" href="{{links.prev}}">‚Üê Anterior</a>{{/if}}
                        <span> P√°gina {{meta.page}} / {{meta.total_pages}} </span>
                        {{#if links.next}}<a class="btn" href="{{links.next}}">Siguiente ‚Üí</a>{{/if}}
                    </div>
                {{/if}}
        </div>
    <div class="table-responsive">
        <table class="users-table">
            <thead>
                <tr class="header-row">
                    <th>ID</th>
                    <th>Avatar</th>
                    <th>Usuario</th>
                    <th>Nombre completo</th>
                    <th>Rol</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {{#each users}}
                <tr class="user-row">
                    <td style="font-weight:600; color:#FFD700;">{{id}}</td>
                                        <td>
                                                {{#if avatar}}
                                                    <img src="{{avatar}}" alt="avatar" class="avatar-img">
                                                {{else}}
                                                    <span class="no-avatar">Sin avatar</span>
                                                {{/if}}
                                        </td>
                    <td style="font-weight:600;">{{username}}</td>
                    <td>{{full_name}}</td>
                    <td>
                        <span class="role-badge badge-{{role}}">{{#if (eq role 'admin')}}Admin{{else}}Player{{/if}}</span>
                    </td>
                    <td>
                        <a class="btn small" href="/admin/users/{{id}}/ledger">üìñ Libro</a>
                        <a class="btn small" href="/admin/users/{{id}}/edit">Editar</a>
                        <form action="/admin/users/{{id}}/delete" method="POST" style="display:inline">
                            <button class="btn small danger" type="submit" onclick="return confirm('¬øEliminar usuario?')">Eliminar</button>
                        </form>
                    </td>
                </tr>
                {{/each}}
            </tbody>
        </table>
    </div>
</div>

<style>
.search-section {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, rgba(57, 73, 171, 0.08) 0%, rgba(33, 150, 243, 0.06) 100%);
    border: 1px solid rgba(100, 181, 246, 0.2);
    border-radius: 12px;
}

.search-form {
    margin-bottom: 0;
}

.search-box {
    display: flex;
    gap: 0.75rem;
    align-items: center;
}

#searchInput {
    flex: 1;
    padding: 0.75rem 1rem;
    font-size: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(100, 181, 246, 0.3);
    border-radius: 8px;
    color: #fff;
    transition: all 0.2s ease;
}

#searchInput:focus {
    outline: none;
    border-color: #64b5f6;
    box-shadow: 0 0 0 3px rgba(100, 181, 246, 0.1);
}

.btn-search {
    background: linear-gradient(135deg, #3949ab 0%, #1976d2 100%);
    padding: 0.75rem 1.5rem;
    white-space: nowrap;
}

.btn-search:hover {
    background: linear-gradient(135deg, #1976d2 0%, #3949ab 100%);
}

.btn-clear {
    background: rgba(255, 255, 255, 0.1);
    padding: 0.75rem 1.5rem;
    color: #ff7043;
    white-space: nowrap;
}

.btn-clear:hover {
    background: rgba(255, 255, 255, 0.15);
}

.search-results-info {
    margin-top: 1rem;
    color: #64b5f6;
    font-size: 0.95rem;
}

.search-results-info strong {
    color: #fff;
}
</style>
